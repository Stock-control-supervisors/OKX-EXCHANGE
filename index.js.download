!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports._prohibitedMonitor=t():e._prohibitedMonitor=t()}(this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.r(t);var s=/([^{]+)({.+})?/,u=/^{|}$/g,l=/^['"]|['"]$/g,f=/\/\/([^/]+)\//,p={serializeParams:function(e){for(var t=[],n=Object.keys(e),r=0,o=n.length;r<o;r++){var i=n[r];t.push("".concat(encodeURIComponent(i),"=").concat(encodeURIComponent(e[i])))}return t.join("&")},getUrlDomain:function(e){var t=e.match(f);return t?t[1]:""},getUrlQuery:function(e){return this.getParsedUrl(window.location.href).searchParams.get(e)||""},getParsedUrl:function(e){return new URL(e)},getChannelContext:function(e){var t={channelId:"",referralSrc:""};if(!e)return t;var n="",r="";if(e.searchParams.forEach(function(e,t){var o=t.toLowerCase();"channelid"===o&&(n=e),"channelflag"===o&&(r=e)}),t.channelId=n||r,t.channelId)return t;if(e.pathname.endsWith("/join"))return t;if(!e.pathname.includes("/join"))return t;var o=e.pathname.split("".concat("/join","/"))[1];if(!o)return t;var i=o.split("/")[0];if(i.startsWith("-"))return t;var a=i.split("-"),c=a[a.length-2]||"";return(n=a[a.length-1])&&(t.referralSrc=c,t.channelId=n),t},getOriginalUrl:function(e){return e.replace(/([?&])t=\d+(&)?/,function(e,t,n){return t&&n?t===n?"&":"?":""})},setCookie:function(e,t,n){var r=new Date;r.setTime(r.getTime()+n),document.cookie="".concat(e,"=").concat(encodeURIComponent(t),";expires=").concat(r.toGMTString(),";path=/")},getCookie:function(e){var t=new RegExp("(^| )".concat(e,"=([^;]*)(;|$)")),n=document.cookie.match(t);return n?decodeURIComponent(n[2]):""},parseTarget:function(e){var t=e.match(s),n={key:"",data:{}};if(t){var r=t[1],o=t[2],i={};if(o)o.replace(u,"").split(",").forEach(function(e){var t=e.split(":"),n=a(t=t.map(function(e){return e.trim().replace(l,"")}),2),r=n[0],o=n[1];i[r]=o});n.key=r,n.data=i}return n},matchType:function(e,t){return Object.prototype.toString.call(e)==="[object ".concat(t,"]")},isArray:function(e){return this.matchType(e,"Array")},isObject:function(e){return this.matchType(e,"Object")},isInArray:function(e,t){if(Array.prototype.includes)return e.includes(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return!0;return!1},generateUUID:function(){var e=Date.now()+window.performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})},valueExists:function(e){return void 0!=e&&""!==e},passedNamingCheck:function(e){return!/[^a-z0-9_]/.test(e)},toFixed:function(e){return Number(e.toFixed(4))},toUnderLineFormat:function(e){return e.replace(/([A-Z])/g,function(e,t,n){return 0===n?"".concat(t.toLowerCase()):"_".concat(t.toLowerCase())})},filterXSS:function(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&#34;")},merge:function(e,t){var n={};return Object.keys(o(o({},e),t)).forEach(function(r){var o;null==t[r]&&null==e[r]||(n[r]=null!==(o=t[r])&&void 0!==o?o:e[r])}),n},base64Id:function(){for(var e="",t=0;t<22;++t)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".charAt(Math.floor(64*Math.random()));return e},isTargetingCookiesRejected:function(){if("undefined"==typeof window)return!1;if(void 0===window.OnetrustActiveGroups)return!1;try{return!window.OnetrustActiveGroups.includes("C0004")}catch(e){return!1}}};function d(e){"@babel/helpers - typeof";return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var g=function(e){var t,n=new Set,r=function(e,r){var o="function"==typeof e?e(t):e;if(o!==t){var i=t;t=(null!==r&&void 0!==r?r:"object"!==d(o))?o:Object.assign({},t,o),n.forEach(function(e){return e(t,i)})}},o=function(){return t},i={setState:r,getState:o,subscribe:function(e){return n.add(e),function(){return n.delete(e)}},destroy:function(){return n.clear()}};return t=e(r,o,i),i}(function(e){return{deviceId:"",requestAmpWhiteListComplete:!1,needDurationActions:[],needDurationActionParams:{},actionTriggerTimes:{},setDeviceId:function(t){return e(function(){return{deviceId:t}})},setRequestAmpWhiteListComplete:function(t){return e(function(){return{requestAmpWhiteListComplete:t}})},setNeedDurationActions:function(t){return e(function(){return{needDurationActions:t}})},setNeedDurationActionParams:function(t){return e(function(){return{needDurationActionParams:t}})},setActionTriggerTimes:function(t){return e(function(){return{actionTriggerTimes:t}})}}}),m="undefined"!=typeof window,v="undefined"==typeof window||!!Object({NODE_ENV:"production",ASSETS_BUILD_TYPE:"publish",ASSETS_BUILD_VERSION:"2.6.62"}).SSR_ENV,h=!!m&&/OKApp\/\(\S+\/\S+\)/i.test(navigator.userAgent),y=!0,b={_expires:{}},w={};if(m){var S=(w=window._okGlobal||window.okGlobal||{}).broker&&w.broker.is,O="1"===localStorage.simulatedTrading,_=(w.site&&w.site.is||{}).okjp;y=S||O||!0===_;var E=localStorage.ok_monitor,I=void 0===E?'{ "_expires": {} }':E;b=JSON.parse(I)}var k={},P={setEnv:function(e){var t,n,r=window.screen,o=localStorage._tk,i=null===(t=window.utils.ont)||void 0===t?void 0:null===(n=t.getDeviceId)||void 0===n?void 0:n.call(t),a=g.getState().deviceId,c=navigator,s=c.systemLanguage,u=c.language,l=document.referrer;k.site=e.site,k.lcl=p.getCookie("locale"),l&&(l.length>256&&(l=l.substr(0,256)),k.rf=l),o&&(k.tk=o),k.uid=a||i,k.lan=(s||u).toLowerCase();var f="0x0";if(r){var d=r.width,m=r.height;f="".concat(d,"x").concat(m)}k.scr=f;var v=p.getCookie("first_ref");v&&(v.length>256&&(v=v.substr(0,256)),k.frf=v)},getEnv:function(){return k},isInApp:function(){return h},toLocalStorage:function(e){var t=e.key,n=e.value,r=e.maxAge;b[t]=n,b._expires[t]=Date.now()+r,localStorage.ok_monitor=JSON.stringify(b)},removeLocalStorage:function(e){delete b[e],delete b._expires[e],localStorage.ok_monitor=JSON.stringify(b)},getClientValue:function(e){var t=sessionStorage.getItem(e);return t||this.getValueFromLocalStorage(e)},getValueFromLocalStorage:function(e){return Date.now()<b._expires[e]&&b[e]||""},syncUpLocalStorageToSessionStorage:function(e){if(!sessionStorage.getItem(e)){var t=this.getValueFromLocalStorage(e);t&&sessionStorage.setItem(e,t)}},shouldIgnoreAmpEvent:function(){return y},isOKEx:function(){return w.site&&"okex"===w.site.sign},isOKLink:function(){var e=w.site;return e&&("oklink"===e.sign||"okex"===e.sign&&e.linkInOKX)},isInSSR:function(){return v},isInBrowser:function(){return m},isInExtension:function(){return window.inOKXExtension||window.inUIOKXExtension},isDevTestEnv:function(){return this.isInExtension()?"publish"!==window.ASSETS_BUILD_TYPE:["pre","prod"].indexOf(w.envSign)<0},isProdEnv:function(){return this.isInExtension()?"publish"===window.ASSETS_BUILD_TYPE:"prod"===w.envSign},getOkGlobal:function(){return w},isEnableAMP:function(){return this.isProdEnv()||"true"===sessionStorage.getItem("monitor_amplitude_enable_for_test")},getTk:function(){return h&&window.jsbridge?window.jsbridge.getTK().then(function(e){return e||(localStorage._tk||"")}).catch(function(){}):Promise.resolve(localStorage._tk||"")}},j="",A="";if(P.isInBrowser()){var x=P.getOkGlobal(),T=x.cdnBaseUrl,C=void 0===T?"//static.coinall.ltd":T;x.SaaSEnvType;j=P.isOKLink()?"d77757dff7616a060069e378595de0f7":P.isOKEx()?"56bf9d43d57f079e506b4f26c70a698f":"21c676d501be3d648464d7ae0038cd53",A=C}var L={Actions:{CLICK:"clk",EXPOSE:"xps"},Configs:{ATTR_CLICK:"data-clk",ATTR_EXPOSE:"data-xps",ATTR_LISTEN:"data-lsn",EXPOSE_DURATION:500},REQUEST_LONG_WAIT_TIME:1e3,PERF_REPORT_DEFER_TIME:5e3,AMPLITUDE_API_KEY:j,CDN_BASE_URL:A,MILLISECONDS_OF_30_DAYS:2592e6,YESTERDAY:-864e5,WEB3CATEGORY:["onchain","web3_homepage","wallet","web3_trade","nft","web3_discover","web3_invest","okc","onchain_data"]},D=[{keyword:"baidu.com",type:"BaiduSEO"},{keyword:"google",type:"GoogleSEO"},{keyword:"yandex.com",type:"yandexSEO"},{keyword:"yahoo",type:"yahooSEO"},{keyword:"so.com",type:"360SEO"},{keyword:"bing.com",type:"bingSEO"},{keyword:"sogou.com",type:"sogouSEO"},{keyword:"m.sm.cn",type:"smSEO"},{keyword:"naver.com",type:"naverSEO"}],U=function(){for(var e=p.getUrlDomain(document.referrer),t=0;t<D.length;t++){var n=D[t],r=n.keyword,o=n.type;if(e.indexOf(r)>-1)return o}return""};var R=function(e){var t=e.url,n=void 0===t?"":t,r=e.method,o=void 0===r?"GET":r,i=e.params,a=void 0===i?{}:i,c=e.data,s=void 0===c?{}:c,u=e.contentType,l=void 0===u?"application/json":u,f=e.timeout,d=void 0===f?1e4:f,g=null,m=o.toLocaleUpperCase(),v=p.serializeParams(a),h=v?"".concat(v,"&t=").concat(Date.now()):"t=".concat(Date.now()),y="".concat(n,"?").concat(h),b=JSON.stringify(s);return"application/x-www-form-urlencoded"===l&&(b=p.serializeParams(s)),"undefined"!=typeof fetch&&"undefined"!=typeof AbortController?new Promise(function(e,t){var n=new AbortController,r=n.signal;g=window.setTimeout(function(){window.clearTimeout(g),g=null,n.abort()},d);var o={credentials:"include",headers:{"Content-Type":l},method:m,signal:r};"POST"===m&&(o.body=b),fetch(y,o).then(function(e){if(window.clearTimeout(g),g=null,200===e.status)try{return e.json()}catch(e){t(e)}return t(new Error("".concat(e.status," ").concat(e.statusText))),{}}).then(function(t){e(t)}).catch(function(e){t(e)})}):new Promise(function(e,t){var n=new XMLHttpRequest;g=window.setTimeout(function(){window.clearTimeout(g),g=null,n.abort()},d);var r=null;"POST"===m&&(r=b),n.open(m,y,!0),n.setRequestHeader("Content-type",l),n.send(r),n.onreadystatechange=function(){4===n.readyState&&(window.clearTimeout(g),g=null,200===n.status?e(JSON.parse(n.responseText)):t(new Error("".concat(n.status," ").concat(n.statusText))))},n.onerror=function(e){t(e)}})},N=P.isInBrowser()?JSON.parse(localStorage.__error__||"[]"):[],K=function(e){var t=e.message,n=e.filename,r=e.lineno,o=e.colno,i=e.error,a="";return i&&i.stack?-1!==(a=i.stack).indexOf("@")&&(a="".concat(t," \n\r ").concat(a)):(i||t)&&(a="ThrowError: ".concat(JSON.stringify(i||t)," \n\r at ").concat(n,": ").concat(r,": ").concat(o)),{msg:t,file:n,line:r,col:o,stack:a,url:encodeURIComponent(window.location.href)}},M=function(e){var t=e.file,n=e.line,r=e.col,o="".concat(t,"__").concat(n,"__").concat(r);return N.includes(o)},q=function(e){var t=e.file,n=e.line,r=e.col,o="".concat(t,"__").concat(n,"__").concat(r);N.unshift(o),N.length>50&&N.pop(),setTimeout(function(){localStorage.__error__=JSON.stringify(N)},0)},B=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{expirationDays:365},r=null!==t?n.expirationDays:-1;if(r){var o=new Date;o.setTime(o.getTime()+24*r*60*60*1e3),r=o}var i="".concat(e,"=").concat(t);r&&(i+="; expires=".concat(r.toUTCString())),i+="; path=/",document.cookie=i},G=function(e){try{for(var t=document.cookie.split(";"),n=null,r=0;r<t.length;r++){for(var o=t[r];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(e)){n=o.substring(e.length+1,o.length);break}}return n}catch(e){return null}};function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach(function(t){V(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var W=null,Y=!1,z=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),P.setEnv(t)}return function(e,t,n){t&&X(e.prototype,t),n&&X(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"logPV",value:function(){if(!Y){var e=F({_act:"_pv",_ct:"_pv",_action_type:"Show",_element_type:"Page"},this._getCommonData());this.sendLogs(e),Y=!0}}},{key:"logEvent",value:function(e){var t={},n=e.category,r=e.action,o=e.target,i=e.params,a=e.extras,c=e._m,s=e.anchor,u=e.elementType,l=e.actionType,f=e.tk;if(Object.assign(t,F({_ct:n,_act:r,_lb:encodeURIComponent(o||""),_anchor_en_name:encodeURIComponent(s||""),_element_type:encodeURIComponent(u||""),_action_type:encodeURIComponent(l||"")},this._getCommonData())),t._tk=f||t._tk,p.isArray(i)){var d=0,g=0;i.forEach(function(e,n){if(p.isObject(e)){var r=e.value,o=e.random,i=encodeURIComponent(r);o?t["_unlist".concat(g++)]=i:t["_reser".concat(d++)]=i}else t["_reser".concat(n)]=encodeURIComponent(e)})}else if(p.valueExists(i)){var m=i;p.isObject(i)&&(m=JSON.stringify(i));var v=encodeURIComponent(m);t._v=v,t._reser0=v}if(a){a.page=encodeURIComponent(window.location.href);var h={};Object.keys(a).forEach(function(e){h["__".concat(e)]=a[e]}),Object.assign(t,h)}return c&&(t._m=c),this.sendLogs(t)}},{key:"_getCommonData",value:function(){var e=F({},P.getEnv());localStorage._tk&&(e.tk=localStorage._tk);var t=sessionStorage,n=t.src,r=t.sessionId,o=void 0===r?"":r,i=P.getClientValue("pageId"),a=P.getClientValue("channelId"),c=JSON.parse(G("_monitor_extras")||"{}"),s=c.deviceId,u=void 0===s?p.base64Id():s,l=c.eventId,f=void 0===l?1:l,d=c.sequenceNumber,g=void 0===d?1:d;B("_monitor_extras",JSON.stringify({deviceId:u,eventId:f+1,sequenceNumber:g+1}));var m=JSON.stringify({_amp_rejected:p.isTargetingCookiesRejected(),_device_id:u,_event_id:f,_sequence_number:g,_uuid:p.generateUUID()}),v={_cid:a,_pgid:i,_source:n,_session_id:encodeURIComponent(o.slice(0,256)),_page_url:encodeURIComponent(window.location.href.slice(0,256)),_extras:m};return Object.keys(e).forEach(function(t){v["_".concat(t)]=encodeURIComponent(e[t])}),v}},{key:"sendLogs",value:function(e){var t=this,n=[];if(Object.keys(e).forEach(function(t){var r=e[t];p.valueExists(r)?n.push("".concat(t,"=").concat(r)):delete e[t]}),P.isDevTestEnv()){var r=window.console;return r.groupCollapsed("dev monitor: ".concat(e._ct," > ").concat(e._act)),r.log(decodeURIComponent(JSON.stringify(e,null,2))),r.groupEnd(),Promise.resolve()}return P.isInApp()&&window.jsbridge?window.jsbridge.getTK().then(function(e){if(e){var r="_tk=".concat(encodeURIComponent(e)),o=n.findIndex(function(e){return/^_tk/.test(e)});o>-1?n[o]=r:n.push(r)}return t.addClientInfo(n.join("&"))}).catch(function(){return t.addClientInfo(n.join("&"))}):this.addClientInfo(n.join("&"))}},{key:"addClientInfo",value:function(e){var t=this,n="&_ts=".concat(Date.now(),"&_r=").concat(Math.floor(2147483648*Math.random())),r="?".concat(e).concat(n);return P.isInApp()&&window.jsbridge?window.jsbridge.getClientInfo().then(function(o){var i=o?"&_app_info=".concat(encodeURIComponent(o)):"";return r="?".concat(e).concat(i).concat(n),t.sendRequest(r)}).catch(function(e){return t.sendRequest(r)}):this.sendRequest(r)}},{key:"sendRequest",value:function(e){return new Promise(function(t){if(navigator.sendBeacon&&!P.isInExtension())navigator.sendBeacon("/jsstat/".concat(P.isOKLink()?"oklink":"sb").concat(e)),t();else{var n=!1,r=new Image;r.onload=function(){n||(t(),n=!0)},r.src=P.isInExtension()?"https://www.oklink.com/jsstat/s.gif".concat(e):"/jsstat".concat(P.isOKLink()?"/oklink":"","/s.gif").concat(e),setTimeout(function(){n||(t(),n=!0)},150)}})}}]),e}(),H=function(e){return W||(W=new z(e))},$=L.Actions,Q=L.Configs,Z=function(e,t){document.addEventListener("click",function(n){var r=n.target;r.getAttribute(Q.ATTR_LISTEN)&&t.preprocess();var o=r.getAttribute(Q.ATTR_CLICK);if(o){var i=p.parseTarget(o),a=i.key,c=i.data;a&&e({target:a,action:$.CLICK,params:c,extras:{area:c.area}})}})};function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach(function(t){ne(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var re={},oe=L.Actions,ie=L.Configs,ae={listen:function(e){this.trackFn=e;var t=new window.IntersectionObserver(this.onSectionChange.bind(this),{threshold:[.5,1]});document.querySelectorAll("[".concat(ie.ATTR_EXPOSE,"]")).forEach(function(e){t.observe(e)}),this.observer=t},onSectionChange:function(e){var t=this;e.forEach(function(e){var n=e.target,r=e.isIntersecting,o=n.getAttribute(ie.ATTR_EXPOSE),i=p.parseTarget(o),a=i.key,c=i.data,s=Number(e.time.toFixed(2));if(r){var u=setTimeout(function(){var e=re[a],r=n.getBoundingClientRect(),o=window,i=o.innerHeight,u=o.innerWidth,l=r.top,f=r.bottom,p=r.left,d=r.right;if((l>=0&&l<=i||f>=0&&f<=i)&&(p>=0&&p<=u||d>=0&&d<=u)){var g=c.area,m=c.elementType,v=c.actionType;delete c.area,delete c.elementType,delete c.actionType,t.trackFn({target:a,action:oe.EXPOSE,params:te(te({},c),{},{time:s}),extras:{area:g},actionType:v||"Show",elementType:m,anchor:m?a:""}),t.observer.unobserve(n),e.forEach(function(e){window.clearTimeout(e)}),delete re[a]}else e.shift()},ie.EXPOSE_DURATION);re[a]||(re[a]=[]),re[a].push(u)}})}};function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach(function(t){ue(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var le=L.Configs,fe={listen:function(e){var t=function(t){e.logEvent(se(se({},t),{},{category:"ok"}))};this.preprocess(),Z(t,this),ae.listen(t,this)},preprocess:function(){document.querySelectorAll("[".concat(le.ATTR_LISTEN,"]")).forEach(function(e){var t=e.getAttribute(le.ATTR_LISTEN),n=t.indexOf(":");if(n>-1){var r=t.substring(0,n).trim(),o=t.substring(n+1).trim();r.split("+").forEach(function(t){e.setAttribute("data-".concat(t.trim()),o)}),e.removeAttribute(le.ATTR_LISTEN)}})}};function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var de;function ge(e){return function(e){if(Array.isArray(e))return me(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return me(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ve="RESOLVE",he="REJECT",ye={AMPInstanceInit:!1,getAmpInstancePromise:null,events:new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listeners={}}return function(e,t,n){t&&pe(e.prototype,t),n&&pe(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"on",value:function(e,t,n){for(var r=[],o=arguments.length,i=0;i<o;i++)r.push(arguments[i]);r=r.length>3?r.splice(3,r.length-1):[],void 0!==this.listeners[e]?this.listeners[e].push({scope:n,callback:t,args:r}):this.listeners[e]=[{scope:n,callback:t,args:r}]}},{key:"remove",value:function(e,t,n){if(void 0!==this.listeners[e])for(var r=this.listeners[e].length,o=this.listeners[e].slice(0),i=0;i<r;i++){var a=o[i];a.scope==n&&a.callback==t&&this.listeners[e].splice(i,1)}}},{key:"has",value:function(e,t,n){if(void 0!==this.listeners[e]){var r=this.listeners[e].length;if(void 0===t&&void 0===n)return r>0;for(var o=0;o<r;o++){var i=this.listeners[e][o];if((!n||i.scope==n)&&i.callback==t)return!0}}return!1}},{key:"emit",value:function(e){if(void 0!==this.listeners[e]){for(var t=this.listeners[e].slice(),n=t.length,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];for(var a=0;a<n;a++){var c=t[a];if(c&&c.callback){var s=o.concat(c.args);c.callback.apply(c.scope,s)}}}}}]),e}()),getAmplitudeSDKInstance:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new Promise(function(n,r){e.events.on(ve,function(e){n(e)}),e.events.on(he,function(e){r(e)}),e.getInstance(t)})},getInstance:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return de&&clearTimeout(de),new Promise(function(n,r){var o=window.amplitude,i=sessionStorage.signUpCompleted;P.getTk().then(function(a){var c=t||a;if(o){var s=o.getInstance();return c&&s.setUserId(c),i&&(s.logEvent("signup_completed"),sessionStorage.removeItem("signUpCompleted")),s.options&&e.events.emit(ve,s),void n(s)}e.AMPInstanceInit?e.getAmpInstancePromise.then(function(e){n(e)}).catch(function(e){r(e)}):(e.getAmpInstancePromise=e.getAmpInstance(t),e.AMPInstanceInit=!0,e.getAmpInstancePromise.then(function(e){n(e)}).catch(function(e){r(e)}))})})},getAmpInstance:function(e){var t=this;return new Promise(function(n,r){if(function(){var e=P.getOkGlobal(),t=e.envSign,n=e.cdnBaseUrl,r=window.amplitude||{_q:[],_iq:{}},o=document.createElement("script");o.type="text/javascript",o.integrity="sha384-QahB0HKETlcqjneomU3Ohs+UgJTinhUNFIKJitEl2Vo7DjvphO2jei64ZP5J2GA5",o.crossOrigin="anonymous",o.async=!0;var i="";switch(t){case"dev":i="cdndev";break;case"pre":i="cdnpre";break;case"daily":case"prod":default:i="cdn"}P.isInExtension()?(o.integrity="sha384-pOU6BcU7Xl8BUN1qGu7OTKvbAUHiErbL8FdKEnAhCwR47UmKCyC5mOM9Nqxe02PR",o.src="./scripts/lib/amplitude-8.2.3-min.gz.js"):o.src=n?"".concat(n,"/").concat(i,"/assets/okfe/libs/monitor/amplitude-8.21.8-min.gz.js"):"https://cdn.amplitude.com/libs/amplitude-8.21.8-min.gz.js",o.onload=function(){window.amplitude.runQueuedFunctions||console.log("[Amplitude] Error: could not load SDK")};var a=document.getElementsByTagName("script")[0];function c(e,t){e.prototype[t]=function(){return this._q.push([t].concat(Array.prototype.slice.call(arguments,0))),this}}a.parentNode.insertBefore(o,a);for(var s=function(){return this._q=[],this},u=["add","append","clearAll","prepend","set","setOnce","unset"],l=0;l<u.length;l++)c(s,u[l]);r.Identify=s;for(var f=function(){return this._q=[],this},p=["setProductId","setQuantity","setPrice","setRevenueType","setEventProperties"],d=0;d<p.length;d++)c(f,p[d]);r.Revenue=f;var g=["init","logEvent","logRevenue","setUserId","setUserProperties","setOptOut","setVersionName","setDomain","setDeviceId","enableTracking","setGlobalUserProperties","identify","clearUserProperties","setGroup","logRevenueV2","regenerateDeviceId","groupIdentify","onInit","logEventWithTimestamp","logEventWithGroups","setSessionId","resetSessionId"];function m(e){function t(t){e[t]=function(){e._q.push([t].concat(Array.prototype.slice.call(arguments,0)))}}for(var n=0;n<g.length;n++)t(g[n])}m(r),r.getInstance=function(e){return e=(e&&0!==e.length?e:"$default_instance").toLowerCase(),r._iq.hasOwnProperty(e)||(r._iq[e]={_q:[]},m(r._iq[e])),r._iq[e]},window.amplitude=r}(),window.amplitude){var o=localStorage._tk,i=e||o,a=window.amplitude.getInstance(),c={includeUtm:!0,includeReferrer:!0,includeGclid:!0,logAttributionCapturedEvent:!0,language:P.getOkGlobal().locale};if(Le.apiEndpoint?c.apiEndpoint=Le.apiEndpoint:(P.isOKEx()||P.isOKLink())&&(c.apiEndpoint="".concat(window.location.host,"/amplitude"),c.forceHttps=!1),a.init(L.AMPLITUDE_API_KEY,null,c,function(e){t.events.emit(ve,e)}),i&&(a.setUserId(i),sessionStorage.channelId&&a.setUserProperties({channel_id:sessionStorage.channelId})),sessionStorage.ampCacheEvents)JSON.parse(sessionStorage.ampCacheEvents).forEach(function(e){a.logEvent.apply(a,ge(e))}),sessionStorage.ampCacheEvents="";sessionStorage.signUpCompleted&&(a.logEvent("signup_completed"),sessionStorage.removeItem("signUpCompleted")),n(a)}else r()})}};P.isInBrowser()&&!P.shouldIgnoreAmpEvent()&&(de=setTimeout(function(){de=0,ye.getInstance()},5e3));var be=ye;function we(e){"@babel/helpers - typeof";return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Se=["user_id"];function Oe(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Oe=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var o=t&&t.prototype instanceof f?t:f,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return I()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=w(a,n);if(c){if(c===l)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=u(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===l)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}(e,n,a),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var l={};function f(){}function p(){}function d(){}var g={};c(g,o,function(){return this});var m=Object.getPrototypeOf,v=m&&m(m(E([])));v&&v!==t&&n.call(v,o)&&(g=v);var h=d.prototype=f.prototype=Object.create(g);function y(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function b(e,t){var r;this._invoke=function(o,i){function a(){return new t(function(r,a){!function r(o,i,a,c){var s=u(e[o],e,i);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==we(f)&&n.call(f,"__await")?t.resolve(f.__await).then(function(e){r("next",e,a,c)},function(e){r("throw",e,a,c)}):t.resolve(f).then(function(e){l.value=e,a(l)},function(e){return r("throw",e,a,c)})}c(s.arg)}(o,i,r,a)})}return r=r?r.then(a,a):a()}}function w(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function E(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:I}}function I(){return{value:void 0,done:!0}}return p.prototype=d,c(h,"constructor",d),c(d,"constructor",p),p.displayName=c(d,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,c(e,a,"GeneratorFunction")),e.prototype=Object.create(h),e},e.awrap=function(e){return{__await:e}},y(b.prototype),c(b.prototype,i,function(){return this}),e.AsyncIterator=b,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new b(s(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then(function(e){return e.done?e.value:a.next()})},y(h),c(h,a,"Generator"),c(h,o,function(){return this}),c(h,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=E,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:E(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}function _e(e){return function(e){if(Array.isArray(e))return Ee(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ee(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(n),!0).forEach(function(t){Pe(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function je(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Ae(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Te=!1,Ce=[],Le=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),P.isInSSR()||(this.commonParams=t.commonParams||{},this._logger=H(t),this._site=t.site,this._category=t.product,t.withPV&&this._logger.logPV(),Te||(this._initEventListener(),Te=!0))}return function(e,t,n){t&&xe(e.prototype,t),n&&xe(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"setApiEndpoint",value:function(t){if(/^https?:\/\//.test(t))throw new Error('The content of the URL can not include protocol type as a substring such as "http://" or "https://".');e.apiEndpoint=t}},{key:"report",value:function(e){var t=e.type,n=e.value;if(P.isInSSR())return Promise.resolve();var r=n;return(p.isObject(r)||p.isArray(r))&&(r=JSON.stringify(r)),this._logger.logEvent({category:"performance",action:t,params:r})}},{key:"logPV",value:function(){this._logger.logPV()}},{key:"logAmplitudeEvent",value:function(e,t,n){var r=this;if(P.isInSSR()||P.shouldIgnoreAmpEvent())return Promise.resolve();var o=n,i=!1;p.isObject(n)&&(o=n.tk,i=n.ignoreBackUp);var a={};for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(a[c]=t[c]);if(a.monitor_after_navigation){delete a.monitor_after_navigation;var s=JSON.parse(sessionStorage.ampCacheEvents||"[]");return s.push([e,a]),sessionStorage.ampCacheEvents=JSON.stringify(s),Promise.resolve()}return be.getInstance(o).then(function(n){n.logEvent(e,a),i||r.act(e,t)})}},{key:"resetAmplitudeUser",value:function(){return P.isInSSR()?Promise.resolve():be.getInstance().then(function(e){return e.setUserId(null),e.regenerateDeviceId(),Promise.resolve()})}},{key:"track",value:function(e,t,n,r){if(P.isInSSR())return Promise.resolve();var o={category:this._category,action:n,target:t,params:r,extras:{area:e}};if(p.isObject(e)){var i=e.area,a=e.action,c=e.target,s=e.params;Object.assign(o,{action:a,target:c,params:s,extras:{area:i}})}return this._logger.logEvent(o)}},{key:"act",value:function(){var e=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){Ae(i,r,o,a,c,"next",e)}function c(e){Ae(i,r,o,a,c,"throw",e)}a(void 0)})}}(Oe().mark(function e(t){var n,r,o,i,a,c,s,u,l,f,d,m,v,h,y,b,w,S,O,_,E=arguments;return Oe().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=E.length>1&&void 0!==E[1]?E[1]:{},r=E.length>2&&void 0!==E[2]?E[2]:{isSyncAMP:!1},!P.isInSSR()){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:if(o=this.commonParams||{},i=o.user_id,a=je(o,Se),c={web_mode_okx:p.isInArray(L.WEB3CATEGORY,this._category)?"wallet":"exchange"},s={},u=Object.assign(s,P.isOKEx()?c:{}),l=(null===r||void 0===r?void 0:r.tk)||i,f={category:this._category,params:n,_m:"1"},p.isObject(n)&&(f.params=p.merge(ke(ke({},a),u),n),u=p.merge(P.isOKLink()?ke(ke({},a),u):u,n)),"string"==typeof t?(d=t,f.action=t):(d=t.action||t.anchor,f.action=d,f.anchor=t.anchor,f.actionType=t.actionType,f.elementType=t.elementType,f=ke(ke({},f),{},{params:p.merge(f.params,t.params||{})}),l=t.tk||l,u=p.merge(u,t.params)),f.tk=l,m=g.getState(),v=m.requestAmpWhiteListComplete,h=m.needDurationActions,y=m.needDurationActionParams,b=m.actionTriggerTimes,w=m.setActionTriggerTimes,S=m.setNeedDurationActionParams,P.isEnableAMP()&&(v?(_=JSON.parse(sessionStorage.getItem("monitor_amplitude_list")||"[]"),p.isInArray(_,d)&&this.logAmplitudeEvent(d,u,{tk:l,ignoreBackUp:!0})):(Ce.push({action:d,params:u,tk:l}),O=JSON.parse(localStorage.getItem("monitor_upload_amplitude_stack")||"[]"),localStorage.setItem("monitor_upload_amplitude_stack",JSON.stringify([].concat(_e(O),Ce))),Ce.length=0)),!p.isInArray(h,d)){e.next=21;break}return b[d]=Date.now(),w(b),y[d]=f,S(y),e.abrupt("return",Promise.resolve("The event will be reported when the page is closed"));case 21:return e.abrupt("return",this._logger.logEvent(f));case 22:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"_initEventListener",value:function(){var e=this;window.addEventListener("load",function(){fe.listen(e._logger)}),window.addEventListener("error",function(t){var n=K(t);M(n)||(e._logger.logEvent({category:"error",action:"report",extras:n}),q(n))},!0),window.addEventListener("beforeunload",function(){var t=g.getState(),n=t.needDurationActions,r=t.needDurationActionParams,o=t.actionTriggerTimes,i=t.setNeedDurationActions,a=t.setNeedDurationActionParams,c=t.setActionTriggerTimes;n.length&&n.forEach(function(t){r[t].params.duration=Date.now()-o[t],e._logger.logEvent(r[t])}),i([]),a({}),c({})})}},{key:"initABTest",value:function(e){null!==e&&void 0!==e&&e.exper_flagKey&&null!==e&&void 0!==e&&e.exper_variant&&(Object.assign(this.commonParams,e),this.act("ab_experiment"))}},{key:"setCommonParams",value:function(e){this.commonParams=ke(ke({},this.commonParams),e)}},{key:"triggerReportDuration",value:function(e){var t=g.getState(),n=t.needDurationActions,r=t.setNeedDurationActions;p.isInArray(n,e)||(n.push(e),r(n))}}]),e}(),De=L.MILLISECONDS_OF_30_DAYS,Ue=function(e,t){if(!P.isInSSR()){var n=window.location.pathname;sessionStorage.channelId=e,P.toLocalStorage({key:"channelId",value:e,maxAge:De}),t?(sessionStorage.referralSrc=t,P.toLocalStorage({key:"referralSrc",value:t,maxAge:De})):(sessionStorage.removeItem("referralSrc"),P.removeLocalStorage("referralSrc")),sessionStorage.pageId=n,P.toLocalStorage({key:"pageId",value:n,maxAge:De})}},Re={monitor:{get amplitude(){return P.isInSSR()?{getAmplitudeSDKInstance:function(){return new Promise(function(e,t){t("Currently not a browser environment!")})}}:be},newInstance:function(e){return P.isInSSR()?{setApiEndpoint:function(){},report:function(){return Promise.resolve()},logPV:function(){return Promise.resolve()},logAmplitudeEvent:function(){return Promise.resolve()},resetAmplitudeUser:function(){return Promise.resolve()},track:function(){return Promise.resolve()},act:function(){return Promise.resolve()},_initEventListener:function(){},initABTest:function(){return Promise.resolve()},setCommonParams:function(){},triggerReportDuration:function(){}}:new Le(e)},saveChannelId:function(e){Ue(e)},getChannelId:function(){return sessionStorage.channelId},setDeviceId:function(e){var t=g.getState().setDeviceId;t(e)},getChannelContextFromUrl:function(e){return p.getChannelContext(p.getParsedUrl(e))}},parseUrl:function(){var e=p.getParsedUrl(window.location.href),t=e.searchParams.get("src");t&&sessionStorage.setItem("src",t),this.parseChannelId(e)},parseChannelId:function(e){var t=U(),n=p.getChannelContext(e),r=n.channelId,o=n.referralSrc;!r&&t&&(r=t),(r=p.filterXSS(r))?Ue(r,o):(P.syncUpLocalStorageToSessionStorage("channelId"),sessionStorage.getItem("channelId")&&(P.syncUpLocalStorageToSessionStorage("referralSrc"),P.syncUpLocalStorageToSessionStorage("pageId")))},init:function(){if(!P.isInSSR()){if(P.isEnableAMP()){var e=g.getState().setRequestAmpWhiteListComplete;R({url:"/priapi/v5/support/bigdata/sendAmpList",timeout:5e3}).then(function(t){var n,r,o=P.isOKLink()?null===t||void 0===t?void 0:null===(n=t.data)||void 0===n?void 0:n.oklink_amplitude:null===t||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.amplitude;sessionStorage.setItem("monitor_amplitude_list",JSON.stringify(o)),e(!0),JSON.parse(localStorage.getItem("monitor_upload_amplitude_stack")||"[]").forEach(function(e){var t=e.action,n=e.params,r=e.tk;p.isInArray(o,t)&&Le.prototype.logAmplitudeEvent(t,n,{tk:r,ignoreBackUp:!0})}),localStorage.setItem("monitor_upload_amplitude_stack","[]")}).catch(function(){e(!0)})}if(this.parseUrl(),!p.getCookie("first_ref")&&document.referrer&&p.setCookie("first_ref",document.referrer,De),sessionStorage.getItem("sessionId")||sessionStorage.setItem("sessionId",window.location.href),!window.IntersectionObserver){var t=document.createElement("script");t.src="".concat(L.CDN_BASE_URL,"/cdn/assets/okfe/libs/polyfills/intersection-observer.js"),document.getElementsByTagName("head")[0].appendChild(t)}window.utils=window.utils||{},window.utils.monitor=this.monitor}},saveChannelId:function(e){Ue(e)}};Re.init();t.default=Re.monitor}]).default});